
const inp = "512,137 -> 522,137\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n514,162 -> 514,165 -> 513,165 -> 513,171 -> 526,171 -> 526,165 -> 519,165 -> 519,162\n507,50 -> 507,53 -> 501,53 -> 501,59 -> 516,59 -> 516,53 -> 511,53 -> 511,50\n530,159 -> 534,159\n472,109 -> 472,110 -> 488,110 -> 488,109\n481,88 -> 485,88\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n514,162 -> 514,165 -> 513,165 -> 513,171 -> 526,171 -> 526,165 -> 519,165 -> 519,162\n519,150 -> 519,140 -> 519,150 -> 521,150 -> 521,140 -> 521,150 -> 523,150 -> 523,141 -> 523,150 -> 525,150 -> 525,142 -> 525,150\n519,150 -> 519,140 -> 519,150 -> 521,150 -> 521,140 -> 521,150 -> 523,150 -> 523,141 -> 523,150 -> 525,150 -> 525,142 -> 525,150\n478,85 -> 482,85\n494,32 -> 498,32\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n488,32 -> 492,32\n494,28 -> 498,28\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n485,34 -> 489,34\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n491,26 -> 495,26\n484,85 -> 488,85\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n472,109 -> 472,110 -> 488,110 -> 488,109\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n507,50 -> 507,53 -> 501,53 -> 501,59 -> 516,59 -> 516,53 -> 511,53 -> 511,50\n491,34 -> 495,34\n498,121 -> 498,122 -> 509,122 -> 509,121\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n519,150 -> 519,140 -> 519,150 -> 521,150 -> 521,140 -> 521,150 -> 523,150 -> 523,141 -> 523,150 -> 525,150 -> 525,142 -> 525,150\n507,50 -> 507,53 -> 501,53 -> 501,59 -> 516,59 -> 516,53 -> 511,53 -> 511,50\n484,79 -> 488,79\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n507,125 -> 507,127 -> 505,127 -> 505,134 -> 514,134 -> 514,127 -> 513,127 -> 513,125\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n475,88 -> 479,88\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n507,125 -> 507,127 -> 505,127 -> 505,134 -> 514,134 -> 514,127 -> 513,127 -> 513,125\n514,162 -> 514,165 -> 513,165 -> 513,171 -> 526,171 -> 526,165 -> 519,165 -> 519,162\n514,162 -> 514,165 -> 513,165 -> 513,171 -> 526,171 -> 526,165 -> 519,165 -> 519,162\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n507,50 -> 507,53 -> 501,53 -> 501,59 -> 516,59 -> 516,53 -> 511,53 -> 511,50\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n519,150 -> 519,140 -> 519,150 -> 521,150 -> 521,140 -> 521,150 -> 523,150 -> 523,141 -> 523,150 -> 525,150 -> 525,142 -> 525,150\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n482,32 -> 486,32\n519,150 -> 519,140 -> 519,150 -> 521,150 -> 521,140 -> 521,150 -> 523,150 -> 523,141 -> 523,150 -> 525,150 -> 525,142 -> 525,150\n499,62 -> 499,66 -> 495,66 -> 495,70 -> 510,70 -> 510,66 -> 503,66 -> 503,62\n519,150 -> 519,140 -> 519,150 -> 521,150 -> 521,140 -> 521,150 -> 523,150 -> 523,141 -> 523,150 -> 525,150 -> 525,142 -> 525,150\n472,91 -> 476,91\n488,28 -> 492,28\n507,125 -> 507,127 -> 505,127 -> 505,134 -> 514,134 -> 514,127 -> 513,127 -> 513,125\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n477,119 -> 482,119\n524,159 -> 528,159\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n497,34 -> 501,34\n481,82 -> 485,82\n498,121 -> 498,122 -> 509,122 -> 509,121\n490,115 -> 495,115\n487,82 -> 491,82\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n518,159 -> 522,159\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n499,62 -> 499,66 -> 495,66 -> 495,70 -> 510,70 -> 510,66 -> 503,66 -> 503,62\n503,34 -> 507,34\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n493,88 -> 497,88\n499,62 -> 499,66 -> 495,66 -> 495,70 -> 510,70 -> 510,66 -> 503,66 -> 503,62\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n514,162 -> 514,165 -> 513,165 -> 513,171 -> 526,171 -> 526,165 -> 519,165 -> 519,162\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n507,50 -> 507,53 -> 501,53 -> 501,59 -> 516,59 -> 516,53 -> 511,53 -> 511,50\n527,156 -> 531,156\n498,119 -> 503,119\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n500,32 -> 504,32\n487,88 -> 491,88\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n491,119 -> 496,119\n479,34 -> 483,34\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n519,150 -> 519,140 -> 519,150 -> 521,150 -> 521,140 -> 521,150 -> 523,150 -> 523,141 -> 523,150 -> 525,150 -> 525,142 -> 525,150\n499,62 -> 499,66 -> 495,66 -> 495,70 -> 510,70 -> 510,66 -> 503,66 -> 503,62\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n499,62 -> 499,66 -> 495,66 -> 495,70 -> 510,70 -> 510,66 -> 503,66 -> 503,62\n487,117 -> 492,117\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n496,91 -> 500,91\n519,150 -> 519,140 -> 519,150 -> 521,150 -> 521,140 -> 521,150 -> 523,150 -> 523,141 -> 523,150 -> 525,150 -> 525,142 -> 525,150\n487,75 -> 487,76 -> 499,76 -> 499,75\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n484,91 -> 488,91\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n490,91 -> 494,91\n490,85 -> 494,85\n485,30 -> 489,30\n514,162 -> 514,165 -> 513,165 -> 513,171 -> 526,171 -> 526,165 -> 519,165 -> 519,162\n483,115 -> 488,115\n507,125 -> 507,127 -> 505,127 -> 505,134 -> 514,134 -> 514,127 -> 513,127 -> 513,125\n507,125 -> 507,127 -> 505,127 -> 505,134 -> 514,134 -> 514,127 -> 513,127 -> 513,125\n484,119 -> 489,119\n524,153 -> 528,153\n519,150 -> 519,140 -> 519,150 -> 521,150 -> 521,140 -> 521,150 -> 523,150 -> 523,141 -> 523,150 -> 525,150 -> 525,142 -> 525,150\n491,30 -> 495,30\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n521,156 -> 525,156\n499,62 -> 499,66 -> 495,66 -> 495,70 -> 510,70 -> 510,66 -> 503,66 -> 503,62\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n486,113 -> 491,113\n497,30 -> 501,30\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n507,125 -> 507,127 -> 505,127 -> 505,134 -> 514,134 -> 514,127 -> 513,127 -> 513,125\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n519,150 -> 519,140 -> 519,150 -> 521,150 -> 521,140 -> 521,150 -> 523,150 -> 523,141 -> 523,150 -> 525,150 -> 525,142 -> 525,150\n514,162 -> 514,165 -> 513,165 -> 513,171 -> 526,171 -> 526,165 -> 519,165 -> 519,162\n519,150 -> 519,140 -> 519,150 -> 521,150 -> 521,140 -> 521,150 -> 523,150 -> 523,141 -> 523,150 -> 525,150 -> 525,142 -> 525,150\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n507,125 -> 507,127 -> 505,127 -> 505,134 -> 514,134 -> 514,127 -> 513,127 -> 513,125\n494,117 -> 499,117\n478,91 -> 482,91\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n472,109 -> 472,110 -> 488,110 -> 488,109\n499,62 -> 499,66 -> 495,66 -> 495,70 -> 510,70 -> 510,66 -> 503,66 -> 503,62\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n487,75 -> 487,76 -> 499,76 -> 499,75\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n507,50 -> 507,53 -> 501,53 -> 501,59 -> 516,59 -> 516,53 -> 511,53 -> 511,50\n468,47 -> 468,37 -> 468,47 -> 470,47 -> 470,37 -> 470,47 -> 472,47 -> 472,41 -> 472,47 -> 474,47 -> 474,39 -> 474,47 -> 476,47 -> 476,44 -> 476,47 -> 478,47 -> 478,45 -> 478,47 -> 480,47 -> 480,37 -> 480,47 -> 482,47 -> 482,40 -> 482,47 -> 484,47 -> 484,42 -> 484,47 -> 486,47 -> 486,38 -> 486,47\n480,117 -> 485,117\n494,23 -> 494,22 -> 494,23 -> 496,23 -> 496,17 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,14 -> 500,23 -> 502,23 -> 502,13 -> 502,23 -> 504,23 -> 504,15 -> 504,23\n498,121 -> 498,122 -> 509,122 -> 509,121\n487,75 -> 487,76 -> 499,76 -> 499,75\n507,50 -> 507,53 -> 501,53 -> 501,59 -> 516,59 -> 516,53 -> 511,53 -> 511,50\n462,104 -> 462,99 -> 462,104 -> 464,104 -> 464,98 -> 464,104 -> 466,104 -> 466,102 -> 466,104 -> 468,104 -> 468,97 -> 468,104 -> 470,104 -> 470,96 -> 470,104 -> 472,104 -> 472,99 -> 472,104 -> 474,104 -> 474,100 -> 474,104 -> 476,104 -> 476,96 -> 476,104 -> 478,104 -> 478,97 -> 478,104";

//const inp = "498,4 -> 498,6 -> 496,6\n503,4 -> 502,4 -> 502,9 -> 494,9";

const walls = inp.split("\n").map(z => z.split(" -> ").map(x => x.split(",").map(y => parseInt(y))));
console.log(walls);

let cave = Array(1000).fill(null).map(x => Array(200).fill("."));


const depth = 2 + walls.reduce((acc1, wall) => Math.max(acc1, wall.reduce((acc2, point) => Math.max(acc2, point[1]), 0)), 0);

walls.push([[0, depth], [999, depth]]);


for(let i = 0; i < walls.length; i ++){
	const wall = walls[i];

	for(let j = 0; j < wall.length - 1; j ++){

		const p1 = wall[j];
		const p2 = wall[j+1];

		const d = [Math.sign(p2[0] - p1[0]), Math.sign(p2[1] - p1[1])]

		let point = p1;

		cave[p1[0]][p1[1]] = '#';

		do{
			point = point.map((x, i) => x + d[i]);
			cave[point[0]][point[1]] = '#';
		}while(point[0] != p2[0] || point[1] != p2[1]);
	}
}



let sandPos = [500, 0];
let sandCount = 0;

do{
	//debugger;
	if(cave[sandPos[0]][sandPos[1] + 1] == "."){
		sandPos[1] += 1;
	}
	else if(cave[sandPos[0] - 1][sandPos[1] + 1] == "."){
		sandPos[0] -= 1;
		sandPos[1] += 1;
	}
	else if(cave[sandPos[0] + 1][sandPos[1] + 1] == "."){
		sandPos[0] += 1;
		sandPos[1] += 1;
	}
	else{
		cave[sandPos[0]][sandPos[1]] = "o";
		sandCount ++;
		if(sandPos[1] == 0) break;
		sandPos = [500, 0];
	}

}while(true);


console.log(sandCount);




